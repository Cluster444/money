<% if @account.errors.any? %>
  <div class="form__errors">
    <h4><%= pluralize(@account.errors.count, "error") %> prohibited this account from being saved:</h4>
    <ul>
      <% @account.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<%= form_with model: @account, url: organization_accounts_path(current_organization), class: "form", data: { controller: "account-form" } do |form| %>
  <div class="form__group">
    <%= form.label :name, class: "form__label" %>
    <%= form.text_field :name, class: "form__input", placeholder: "e.g., Checking Account, Cash Wallet", autocomplete: "off" %>
  </div>

  <div class="form__group">
    <%= form.label :posted_balance, "Initial Balance", class: "form__label" %>
    <%= form.number_field :posted_balance, step: "0.01", min: "0", class: "form__input", placeholder: "e.g., 1000.00", autocomplete: "off" %>
    <small class="form__help">For cash/vendor accounts this sets the initial debit amount. For credit cards this sets the initial credit amount.</small>
  </div>

  <div class="form__group">
    <%= form.label :kind, class: "form__label" %>
    <%= form.select :kind, options_for_select(Account.kinds.keys.map { |k| [k.humanize, k] }, @account.kind), {}, 
        class: "form__select", 
        data: { action: "change->account-form#kindChanged", "account-form-target": "kindSelect" } %>
  </div>

  <div data-account-form-target="creditCardFields" style="display: none;">
    <div class="form__group">
      <%= form.label :due_day, "Due Day (1-31)", class: "form__label" %>
      <%= form.number_field :due_day, in: 1..31, class: "form__input", placeholder: "e.g., 15", autocomplete: "off",
          value: @account.credit_card? ? @account.due_day : nil %>
    </div>

    <div class="form__group">
      <%= form.label :statement_day, "Statement Day (1-31)", class: "form__label" %>
      <%= form.number_field :statement_day, in: 1..31, class: "form__input", placeholder: "e.g., 1", autocomplete: "off",
          value: @account.credit_card? ? @account.statement_day : nil %>
    </div>
  </div>

  <%= form.submit "Create Account", class: "btn btn--primary" %>
<% end %>